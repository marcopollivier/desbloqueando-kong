_format_version: "3.0"
_transform: true

# Upstream configuration - Balanceamento igual entre servi√ßos
upstreams:
  - name: api-upstream
    algorithm: round-robin
    healthchecks:
      active:
        http_path: /health
        healthy:
          interval: 30
          http_statuses: [200, 302]
        unhealthy:
          http_statuses: [500, 502, 503, 504]

    targets:
      - target: go-mock-api-1:3001
        weight: 50
      - target: node-mock-api-2:3002
        weight: 50

# Service usando o upstream
services:
  - name: load-balanced-api
    host: api-upstream
    protocol: http

# Routes
routes:
  - name: lb-route
    service: load-balanced-api
    paths: [/api]
    strip_path: true
